(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{796:function(s,a,t){"use strict";t.r(a);var n=t(18),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"linux"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#linux"}},[s._v("#")]),s._v(" linux")]),s._v(" "),t("h2",{attrs:{id:"文件系统"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#文件系统"}},[s._v("#")]),s._v(" 文件系统")]),s._v(" "),t("h3",{attrs:{id:"目录"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#目录"}},[s._v("#")]),s._v(" 目录")]),s._v(" "),t("ol",[t("li",[s._v("bin: 二进制可执行文件")]),s._v(" "),t("li",[s._v("home: 用户目录")]),s._v(" "),t("li",[s._v("lib: 共享库目录")]),s._v(" "),t("li",[s._v("etc: 系统管理和配置文件, host 和 dns 密码等都在这")]),s._v(" "),t("li",[s._v("dev: 设备相关的")]),s._v(" "),t("li",[s._v("tmp: 临时文件, 重启后里面的文件消失")]),s._v(" "),t("li",[s._v("usr: 软件一般安装在这里")])]),s._v(" "),t("h3",{attrs:{id:"文件链接"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#文件链接"}},[s._v("#")]),s._v(" 文件链接")]),s._v(" "),t("p",[s._v("文件链接类似于 windows 下面的快捷方式")]),s._v(" "),t("h3",{attrs:{id:"路径"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#路径"}},[s._v("#")]),s._v(" 路径")]),s._v(" "),t("ul",[t("li",[s._v("相对路径")]),s._v(" "),t("li",[s._v("绝对路径")])]),s._v(" "),t("h2",{attrs:{id:"常用命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#常用命令"}},[s._v("#")]),s._v(" 常用命令")]),s._v(" "),t("h3",{attrs:{id:"grep"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#grep"}},[s._v("#")]),s._v(" grep")]),s._v(" "),t("p",[s._v("Linux grep 命令用于查找文件里符合条件的字符串")]),s._v(" "),t("p",[s._v('grep [OPTION] "查找的字符串" 查找的文件名')]),s._v(" "),t("p",[s._v("参数")]),s._v(" "),t("ul",[t("li",[s._v("-n: 显示找到的文本的行数")]),s._v(" "),t("li",[s._v("-i: 忽略大小写")])]),s._v(" "),t("h3",{attrs:{id:"cp"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#cp"}},[s._v("#")]),s._v(" cp")]),s._v(" "),t("p",[s._v("cp [OPTION] 源文件 目标文件")]),s._v(" "),t("p",[s._v("使用通配符:")]),s._v(" "),t("p",[s._v("cp hello* ./dir1")]),s._v(" "),t("p",[s._v("将以 hello 开头的所有文件复制到当前目录下 dir1 目录下")]),s._v(" "),t("h3",{attrs:{id:"rm"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#rm"}},[s._v("#")]),s._v(" rm")]),s._v(" "),t("p",[s._v("参数")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("-f")]),s._v(" "),t("p",[s._v("强制删除 不给提示")])]),s._v(" "),t("li",[t("p",[s._v("-i")])]),s._v(" "),t("li",[t("p",[s._v("-r")])])]),s._v(" "),t("h3",{attrs:{id:"find"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#find"}},[s._v("#")]),s._v(" find")]),s._v(" "),t("p",[s._v("find [路径][表达式]")]),s._v(" "),t("p",[s._v("表达式")]),s._v(" "),t("p",[s._v("-name 文件/目录?名字")]),s._v(" "),t("p",[s._v("-type d")]),s._v(" "),t("p",[s._v("找目录")]),s._v(" "),t("p",[s._v("-type")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("find")]),s._v(" ./dir5 -name *.c\n")])])]),t("p",[s._v("找到 dir5 下的所有的文件名带.c 的文件")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("find")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v(" -type d\n")])])]),t("h3",{attrs:{id:"tar"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#tar"}},[s._v("#")]),s._v(" tar")]),s._v(" "),t("p",[s._v("tar -czf 打包文件名.tar.gz 目录")]),s._v(" "),t("p",[s._v("tar -zxvf 需要解包的文件名字")]),s._v(" "),t("h3",{attrs:{id:"gzip"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#gzip"}},[s._v("#")]),s._v(" gzip")]),s._v(" "),t("p",[s._v("解压:")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("gzip")]),s._v(" -d 压缩文件名\n")])])]),t("h3",{attrs:{id:"chmod"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#chmod"}},[s._v("#")]),s._v(" chmod")]),s._v(" "),t("p",[s._v("chmod [who][opt] [mode] 文件名")]),s._v(" "),t("p",[s._v("who:")]),s._v(" "),t("p",[s._v("u: 文件所有者")]),s._v(" "),t("p",[s._v("g: 本人所在. 组成员")]),s._v(" "),t("p",[s._v("o: 系统中的其他的用户")]),s._v(" "),t("p",[s._v("a: 所有用户")]),s._v(" "),t("p",[s._v("opt:")]),s._v(" "),t("p",[s._v("+: 增加")]),s._v(" "),t("p",[s._v("-: 减少")]),s._v(" "),t("p",[s._v("=: 使存储权限等于")]),s._v(" "),t("p",[s._v("mode 表示权限:")]),s._v(" "),t("p",[s._v("r: 读权限")]),s._v(" "),t("p",[s._v("w: 写权限")]),s._v(" "),t("p",[s._v("x: 执行权限")]),s._v(" "),t("p",[s._v("对目录使用需要 -R 选项")]),s._v(" "),t("p",[s._v("取消本用户对 chmodcmd 目录的读权限")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" u-r chmodcmd/\n")])])]),t("h3",{attrs:{id:"ln"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ln"}},[s._v("#")]),s._v(" ln")]),s._v(" "),t("p",[s._v("建立符号链接(类似于 windows 快捷方式)")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ln")]),s._v(" -s 源文件 符号链接"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("快捷方式"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("名称\n")])])]),t("h1",{attrs:{id:"第三次课"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#第三次课"}},[s._v("#")]),s._v(" 第三次课")]),s._v(" "),t("h2",{attrs:{id:"系统管理命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#系统管理命令"}},[s._v("#")]),s._v(" 系统管理命令")]),s._v(" "),t("h3",{attrs:{id:"shutdown"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#shutdown"}},[s._v("#")]),s._v(" shutdown")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("shutdown")]),s._v(" -h now //立即关机\n")])])]),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("shutdown")]),s._v(" +5 //五分钟后关机\n")])])]),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("shutdown")]),s._v(" -r now/23:59 // 现在/23:59分 关闭系统再重启\n")])])]),t("h3",{attrs:{id:"halt"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#halt"}},[s._v("#")]),s._v(" halt")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("halt")]),s._v(" -f //强制关机, 危险\n")])])]),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("halt")]),s._v(" -p //关机\n")])])]),t("h3",{attrs:{id:"reboot"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#reboot"}},[s._v("#")]),s._v(" reboot")]),s._v(" "),t("p",[s._v("立刻重启")]),s._v(" "),t("h2",{attrs:{id:"用户管理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#用户管理"}},[s._v("#")]),s._v(" 用户管理")]),s._v(" "),t("p",[s._v("用户的增删改查, 暂时用不到, 不做笔记")]),s._v(" "),t("h3",{attrs:{id:"切换用户命令-sudo"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#切换用户命令-sudo"}},[s._v("#")]),s._v(" 切换用户命令 sudo")]),s._v(" "),t("p",[s._v("切换用户是 su(switch user)")]),s._v(" "),t("p",[s._v("简写: sudo")]),s._v(" "),t("h2",{attrs:{id:"linux-设备管理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#linux-设备管理"}},[s._v("#")]),s._v(" Linux 设备管理")]),s._v(" "),t("p",[s._v("所有设备皆文件")]),s._v(" "),t("h3",{attrs:{id:"设备标识"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#设备标识"}},[s._v("#")]),s._v(" 设备标识")]),s._v(" "),t("h4",{attrs:{id:"主设备号"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#主设备号"}},[s._v("#")]),s._v(" 主设备号")]),s._v(" "),t("ul",[t("li",[s._v("tty: 终端设备")]),s._v(" "),t("li",[s._v("lp: 打印机")]),s._v(" "),t("li",[s._v("hd: IDE 硬盘")]),s._v(" "),t("li",[s._v("sd: SCSI 硬盘")])]),s._v(" "),t("h4",{attrs:{id:"次设备号"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#次设备号"}},[s._v("#")]),s._v(" 次设备号")]),s._v(" "),t("p",[s._v("如 hda hdb tty0 lp0")]),s._v(" "),t("p",[s._v("用于区分多个设备, 比如多个硬. 打印机")]),s._v(" "),t("h2",{attrs:{id:"磁盘和分区管理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#磁盘和分区管理"}},[s._v("#")]),s._v(" 磁盘和分区管理")]),s._v(" "),t("h3",{attrs:{id:"fdisk"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#fdisk"}},[s._v("#")]),s._v(" fdisk")]),s._v(" "),t("h2",{attrs:{id:"进程管理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#进程管理"}},[s._v("#")]),s._v(" 进程管理")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("Linux 系统上所有运行的东西都可以称为进程")])]),s._v(" "),t("li",[t("p",[s._v("进程三种状态: "),t("strong",[s._v("运行态")]),s._v(" "),t("strong",[s._v("就绪态")]),s._v(" "),t("strong",[s._v("阻塞态")])])]),s._v(" "),t("li",[t("p",[s._v("进程大致可以分为: "),t("strong",[s._v("系统进程")]),s._v(" "),t("strong",[s._v("用户进程")])])])]),s._v(" "),t("h3",{attrs:{id:"命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#命令"}},[s._v("#")]),s._v(" 命令")]),s._v(" "),t("p",[s._v("进程查看")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" aux\n")])])]),t("ul",[t("li",[t("p",[s._v("at 命令")]),s._v(" "),t("p",[s._v("at -f /home/user/pwd_script 03:15")])]),s._v(" "),t("li",[t("p",[s._v("wait 命令")])]),s._v(" "),t("li",[t("p",[s._v("kill [-s 信号 | -p][-a] 进程号")]),s._v(" "),t("p",[s._v("kill -l [信号]")])])]),s._v(" "),t("h2",{attrs:{id:"日志"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#日志"}},[s._v("#")]),s._v(" 日志")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("/var/log/dmesg")]),s._v(" "),t("p",[s._v("内核启动信息")])]),s._v(" "),t("li",[t("p",[s._v("/var/log/messages")]),s._v(" "),t("p",[s._v("内核错误和应用程序错误")])]),s._v(" "),t("li",[t("p",[s._v("/var/log/wtmp 和 /var/run/utmp")]),s._v(" "),t("p",[s._v("用户登录和操作的记录")])])]),s._v(" "),t("h1",{attrs:{id:"第四次课"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#第四次课"}},[s._v("#")]),s._v(" 第四次课")]),s._v(" "),t("h2",{attrs:{id:"shell-编程"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#shell-编程"}},[s._v("#")]),s._v(" shell 编程")]),s._v(" "),t("h3",{attrs:{id:"输入输出重定向"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#输入输出重定向"}},[s._v("#")]),s._v(" 输入输出重定向")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("输入: 文件中读入")]),s._v(" "),t("p",[s._v("小于符号 <")])]),s._v(" "),t("li",[t("p",[s._v("输出: > 符号. 可以将控制台的内容输出到文件")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".txt\n")])])]),t("p",[s._v("追加: >> 在源文件后增加内容")]),s._v(" "),t("p",[s._v("用一个 > 会覆盖原文件")])]),s._v(" "),t("li",[t("p",[s._v("错误信息输出")]),s._v(" "),t("p",[s._v("cmd [参数] 2 文件名")])])]),s._v(" "),t("h3",{attrs:{id:"管道命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#管道命令"}},[s._v("#")]),s._v(" 管道命令")]),s._v(" "),t("p",[s._v("命令的输出做另一个命令的输入 符号 | 表示")]),s._v(" "),t("h3",{attrs:{id:"shell-基础-特殊字符"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#shell-基础-特殊字符"}},[s._v("#")]),s._v(" shell 基础 特殊字符")]),s._v(" "),t("ol",[t("li",[t("p",[s._v("通配符")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("* 任何字符串\n? 单个字符\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" 字符组中的一部分\n")])])])]),s._v(" "),t("li",[t("p",[s._v("引号")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("单引号: 特殊字符变为普通字符\n双引号: 除 $ "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v(" '  \" 这几个依然是特殊字符 其他字符变为普通字符\n")])])]),t("p",[s._v("$ 变量命名")])]),s._v(" "),t("li",[t("p",[s._v("反引号")]),s._v(" "),t("p",[s._v("反引号括起来的会被 shell 解释为命令 并且首先执行 并用标准输出结果代替反引号里的内容")])]),s._v(" "),t("li",[t("p",[s._v("注释")]),s._v(" "),t("h1",{attrs:{id:""}},[t("a",{staticClass:"header-anchor",attrs:{href:"#"}},[s._v("#")])])]),s._v(" "),t("li",[t("p",[s._v("别名")]),s._v(" "),t("p",[s._v("alias alias-name='origin cmd'")])])]),s._v(" "),t("h2",{attrs:{id:"shell-脚本"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#shell-脚本"}},[s._v("#")]),s._v(" shell 脚本")]),s._v(" "),t("p",[s._v("shell 是按行一条接着一条的解释并执行 shell 脚本中的命令")]),s._v(" "),t("h3",{attrs:{id:"命令执行"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#命令执行"}},[s._v("#")]),s._v(" 命令执行")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sh")]),s._v(" 脚本名字\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("bash")]),s._v(" 脚本名字\n./脚本名字 /*当前路径下*/\n")])])]),t("p",[s._v("sh 方法不需要脚本有执行权限")]),s._v(" "),t("p",[s._v("./ 方法必须有")]),s._v(" "),t("ul",[t("li",[s._v("sh 启动新的 shell 执行脚本")]),s._v(" "),t("li",[s._v("./ 当前 shell 执行脚本")])]),s._v(" "),t("h2",{attrs:{id:"shell-变量"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#shell-变量"}},[s._v("#")]),s._v(" shell 变量")]),s._v(" "),t("p",[s._v("一个 shell 终端就是一个进程")]),s._v(" "),t("h3",{attrs:{id:"shift"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#shift"}},[s._v("#")]),s._v(" shift")]),s._v(" "),t("p",[s._v("使命令行输入的位置参数左移")]),s._v(" "),t("ul",[t("li",[s._v("env 命令查看当前 shell 环境变量")]),s._v(" "),t("li",[s._v("用户提示符 # root $普通用户")])]),s._v(" "),t("h3",{attrs:{id:"read-变量名-读入键盘输入-赋值给变量"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#read-变量名-读入键盘输入-赋值给变量"}},[s._v("#")]),s._v(" read [变量名]: 读入键盘输入 赋值给变量")]),s._v(" "),t("h3",{attrs:{id:"echo"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#echo"}},[s._v("#")]),s._v(" echo")]),s._v(" "),t("p",[s._v("echo 默认换行")]),s._v(" "),t("h3",{attrs:{id:"export"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#export"}},[s._v("#")]),s._v(" export")]),s._v(" "),t("p",[s._v("父 shell 导入 变量给子 shell")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("例子")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("父 shell 文件")]),s._v(" "),t("p",[s._v("father.sh")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#! /bin/bash")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("var1")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"the first var"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("var2")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"the second var"')]),s._v(" //export命令 不加这个不会输出到son.sh shell中\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sh")]),s._v(" son.sh //运行之后会运行son.sh脚本的内容. "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sh")]),s._v(" 后面的是子shell文件名 类似函数传参"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("这样说不是特别准确"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(". 不过这是在两个文件中传递（说成在两个shell中传递更准）\n")])])])]),s._v(" "),t("li",[t("p",[s._v("子 shell 文件")]),s._v(" "),t("p",[s._v("son.sh")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#! /bin/bash")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$var1")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$var2")]),s._v("\n")])])])]),s._v(" "),t("li",[t("p",[s._v("运行 father.sh")]),s._v(" "),t("p",[s._v("命令: sh father.sh")]),s._v(" "),t("p",[s._v("运行之后会运行 son.sh 脚本的内容.")]),s._v(" "),t("p",[s._v("输出为:")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("\t\t\t//由于 var1没有被传入 输出为空\nthe second var //var2传递过来了 有输出内容\n")])])])])])])]),s._v(" "),t("h1",{attrs:{id:"第五次课"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#第五次课"}},[s._v("#")]),s._v(" 第五次课")]),s._v(" "),t("h2",{attrs:{id:"or-运算"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#or-运算"}},[s._v("#")]),s._v(" OR 运算")]),s._v(" "),t("p",[s._v("|| 连接多条命令, 依次执行, 若有一条指令执行返回值为 false, 后面的指令就停止执行.")]),s._v(" "),t("h2",{attrs:{id:"计算"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#计算"}},[s._v("#")]),s._v(" 计算")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("expr")])]),s._v(" "),t("li",[t("p",[s._v("let")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("let")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"a=2"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"b=3"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("let")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("c")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("a*b\n")])])]),t("p",[s._v("使用 let 命令时, 变量前的")])])]),s._v(" "),t("h2",{attrs:{id:"if-script"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#if-script"}},[s._v("#")]),s._v(" if_script:")]),s._v(" "),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#! bin/bsah")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# this script is about if")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('" abc is the username? input yes or no"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("read")]),s._v(" name\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$name")]),s._v('"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"yes"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"hello abc!"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"abc is not your name"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fi")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n")])])]),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#! /bin/bash")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"yes or no"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("read")]),s._v(" name\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$name")]),s._v('"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"yes"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"hello abc!"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("elif")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$name")]),s._v('"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"no"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"you inputed no"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"error"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fi")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n\n")])])]),t("div",{staticClass:"language-sh extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#! bin/bash")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"enter the week number"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("read")]),s._v(" number\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("case")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$number")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"zhou yi"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"er"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"san"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        *"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"number must between 1 and 7"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("esac")]),s._v("\n\n")])])]),t("h1",{attrs:{id:"第六次课"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#第六次课"}},[s._v("#")]),s._v(" 第六次课")]),s._v(" "),t("h2",{attrs:{id:"_6-1-gcc"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-1-gcc"}},[s._v("#")]),s._v(" 6.1 gcc")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("gcc -o 程序名字 源文件.c 头文件.h "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n")])])]),t("p",[s._v("头文件在其他目录")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("gcc -o -I头文件目录名 程序名字 源文件.c 头文件.h "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n")])])]),t("p",[s._v("例子")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("gcc -o -I./head 程序名字 源文件.c 头文件.h "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n")])])]),t("p",[s._v("当前文件夹下的 head 文件夹下寻找头文件")]),s._v(" "),t("h2",{attrs:{id:"_6-2-makefile"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-2-makefile"}},[s._v("#")]),s._v(" 6.2 Makefile")]),s._v(" "),t("p",[s._v("make 命令会检测一个大型程序, 代码改变后哪些部分需要重新编译.")]),s._v(" "),t("p",[s._v("简单来说: gcc 命令的集合")]),s._v(" "),t("p",[s._v("流程")]),s._v(" "),t("ol",[t("li",[s._v("读入 "),t("strong",[s._v("Makefile")]),s._v(" 文件")]),s._v(" "),t("li",[s._v("初始化变量")]),s._v(" "),t("li",[s._v("待补充")])]),s._v(" "),t("h3",{attrs:{id:"_6-2-1-内容"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-2-1-内容"}},[s._v("#")]),s._v(" 6.2.1 内容")]),s._v(" "),t("ol",[t("li",[t("p",[s._v("显式规则")])]),s._v(" "),t("li",[t("p",[s._v("隐含规则")]),s._v(" "),t("p",[s._v("makefile 自带的规则")])])]),s._v(" "),t("h4",{attrs:{id:"_6-2-1-1-显示-格式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-2-1-1-显示-格式"}},[s._v("#")]),s._v(" 6.2.1.1 显示 格式")]),s._v(" "),t("p",[s._v("目标: 依赖")]),s._v(" "),t("p",[s._v("命令")]),s._v(" "),t("p",[s._v("例子")]),s._v(" "),t("ol",[t("li",[t("p",[s._v("新建 makefile 文件")]),s._v(" "),t("p",[s._v("vi makefile")])])]),s._v(" "),t("div",{staticClass:"language-makefile extra-class"},[t("pre",{pre:!0,attrs:{class:"language-makefile"}},[t("code",[t("span",{pre:!0,attrs:{class:"token symbol"}},[s._v("hello")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" hello.c\n\tgcc -o hello hello.c\n")])])]),t("p",[s._v("hello(可执行文件) 依赖于 hello.c(源文件)")]),s._v(" "),t("p",[s._v("下面的命令时编译命令.")]),s._v(" "),t("ol",[t("li",[s._v("vi hello.c")])]),s._v(" "),t("div",{staticClass:"language-C extra-class"},[t("pre",{pre:!0,attrs:{class:"language-c"}},[t("code",[t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("include")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("<stdio.h>")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n     "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("printf")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"hello world changed \\n"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),t("p",[s._v("执行命令 make 可以自动编译为可执行文件")]),s._v(" "),t("p",[s._v("修改 hello.c 再执行 make")]),s._v(" "),t("h3",{attrs:{id:"_6-3-命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-3-命令"}},[s._v("#")]),s._v(" 6.3 命令")]),s._v(" "),t("h4",{attrs:{id:"clean"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#clean"}},[s._v("#")]),s._v(" clean")]),s._v(" "),t("p",[s._v("clean:")]),s._v(" "),t("p",[s._v("rm ...")]),s._v(" "),t("p",[s._v("清理文件")]),s._v(" "),t("h4",{attrs:{id:"make"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#make"}},[s._v("#")]),s._v(" make")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" 可执行文件名字\n")])])]),t("p",[s._v("只对 这个可执行文件执行 make 命令")]),s._v(" "),t("h3",{attrs:{id:"_6-4-变量"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-4-变量"}},[s._v("#")]),s._v(" 6.4 变量")]),s._v(" "),t("p",[s._v("变量可代表命令")]),s._v(" "),t("ol",[t("li",[t("p",[s._v("大小写敏感")])]),s._v(" "),t("li",[t("p",[s._v("内部定义")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("$@")]),s._v(" "),t("p",[s._v("目标文件")])]),s._v(" "),t("li",[t("p",[s._v("$^")]),s._v(" "),t("p",[s._v("所有依赖文件")])]),s._v(" "),t("li",[t("p",[s._v("$<")]),s._v(" "),t("p",[s._v("第一个依赖文件")])])])])]),s._v(" "),t("p",[s._v("例子")]),s._v(" "),t("div",{staticClass:"language-makefile extra-class"},[t("pre",{pre:!0,attrs:{class:"language-makefile"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#makefile")]),s._v("\n\n")])])]),t("h3",{attrs:{id:"_6-5-隐含规则"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-5-隐含规则"}},[s._v("#")]),s._v(" 6.5 隐含规则")]),s._v(" "),t("p",[s._v("C 程序 .o 文件由 .c 生成")]),s._v(" "),t("p",[s._v("C++ 由 .cc 生成")]),s._v(" "),t("p",[s._v("将 gcc 名字设置为变量, 方便以后切换版本")]),s._v(" "),t("p",[s._v("隐含条件简化命令")]),s._v(" "),t("div",{staticClass:"language-makefile extra-class"},[t("pre",{pre:!0,attrs:{class:"language-makefile"}},[t("code",[t("span",{pre:!0,attrs:{class:"token symbol"}},[s._v("main.o")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" main.c **.h\n")])])]),t("h3",{attrs:{id:"_6-3-makefile-使用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-3-makefile-使用"}},[s._v("#")]),s._v(" 6.3 Makefile 使用")]),s._v(" "),t("h4",{attrs:{id:"make-执行过程"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#make-执行过程"}},[s._v("#")]),s._v(" make 执行过程")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("查找顺序")]),s._v(" "),t("ol",[t("li",[t("p",[s._v("GNUmake")]),s._v(" "),t("p",[s._v("...")]),s._v(" "),t("p",[s._v("makefile")])])])])]),s._v(" "),t("h2",{attrs:{id:"_6-4-gdb-调试器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-4-gdb-调试器"}},[s._v("#")]),s._v(" 6.4 GDB 调试器")]),s._v(" "),t("p",[s._v("编译错误")]),s._v(" "),t("p",[s._v("运行错误时用 GDB 调试")]),s._v(" "),t("h2",{attrs:{id:"_6-5-库-lib"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-5-库-lib"}},[s._v("#")]),s._v(" 6.5 库 lib")]),s._v(" "),t("h3",{attrs:{id:"定义"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#定义"}},[s._v("#")]),s._v(" 定义")]),s._v(" "),t("h3",{attrs:{id:"库函数"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#库函数"}},[s._v("#")]),s._v(" 库函数：")]),s._v(" "),t("p",[s._v("系统提供，供程序员调用，完成特定功能的函数，一般是 .o 文件。")]),s._v(" "),t("h3",{attrs:{id:"静态库"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#静态库"}},[s._v("#")]),s._v(" 静态库")]),s._v(" "),t("ul",[t("li",[s._v("一般以 .a 结尾。")]),s._v(" "),t("li",[s._v("编译时：库函数合并在可执行文件中")]),s._v(" "),t("li",[s._v("执行时：提供程序即可")]),s._v(" "),t("li",[s._v("可执行文件会变大")])]),s._v(" "),t("h3",{attrs:{id:"共享库"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#共享库"}},[s._v("#")]),s._v(" 共享库")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("以 .so .so.x 结尾")])]),s._v(" "),t("li",[t("p",[s._v("其他性质与静态库相反")]),s._v(" "),t("p",[s._v("编译不加入")]),s._v(" "),t("p",[s._v("执行时要提供库文件")]),s._v(" "),t("p",[s._v("执行文件较小。多个可执行文件可以共享，适合大型程序。")])])]),s._v(" "),t("h3",{attrs:{id:"制作静态库"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#制作静态库"}},[s._v("#")]),s._v(" 制作静态库")]),s._v(" "),t("p",[s._v("gcc 生成 .o 文件 再用 ar -rc 打包")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("gcc -c stack.c\n")])])]),t("hr"),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("ar -rc libstack.a stack.o\n")])])]),t("p",[s._v("源文件 stack.c")]),s._v(" "),t("p",[s._v("gcc 命令生成 stack.o 文件")]),s._v(" "),t("p",[s._v("打包后的静态库：libstack.a")]),s._v(" "),t("h3",{attrs:{id:"使用静态库"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用静态库"}},[s._v("#")]),s._v(" 使用静态库")]),s._v(" "),t("p",[s._v("编译 main.c 时用 -L 参数加入静态库")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("gcc -o main main.c -L./ -lstack\n")])])]),t("p",[s._v("然后运行 main")]),s._v(" "),t("h3",{attrs:{id:"动态库"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#动态库"}},[s._v("#")]),s._v(" 动态库")]),s._v(" "),t("h4",{attrs:{id:"制作"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#制作"}},[s._v("#")]),s._v(" 制作")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("gcc stack.c -fPIC -shared -o libstack2.so\n")])])]),t("p",[s._v("shared：共享库")]),s._v(" "),t("p",[s._v("-fPIC： f 为选项 PIC 为参数：位置无关代码。（待修改）")]),s._v(" "),t("h3",{attrs:{id:"使用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用"}},[s._v("#")]),s._v(" 使用")]),s._v(" "),t("p",[s._v("编译 main.c 加 L 参数，和使用静态库命令一样")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("gcc -o main2 main.c -L./ -lstack2\n")])])]),t("p",[s._v("main2 中没有共享库的代码。只复制 main2 给别人不能直接执行，除非同时提供库文件。")]),s._v(" "),t("h3",{attrs:{id:"添加共享库"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#添加共享库"}},[s._v("#")]),s._v(" 添加共享库")]),s._v(" "),t("p",[s._v("设置环境变量，告诉系统动态库在哪里。")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("LD_LIBRARY_PATH")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("./"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改共享库路径环境变量为当前目录")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$LD_LIBRARY_PATH")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看环境变量")]),s._v("\n")])])]),t("h1",{attrs:{id:"第七次课"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#第七次课"}},[s._v("#")]),s._v(" 第七次课")]),s._v(" "),t("h2",{attrs:{id:"_7-1-命令行参数"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_7-1-命令行参数"}},[s._v("#")]),s._v(" 7.1 命令行参数")]),s._v(" "),t("p",[s._v("传入给 main 函数")]),s._v(" "),t("div",{staticClass:"language-c extra-class"},[t("pre",{pre:!0,attrs:{class:"language-c"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" argc"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("char")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("argv"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])])]),t("ul",[t("li",[t("p",[s._v("argc")]),s._v(" "),t("p",[s._v("命令行参数个数，执行程序名称算一个 + 用户输入的参数个数")])]),s._v(" "),t("li",[t("p",[s._v("*argv[]")]),s._v(" "),t("p",[s._v("第一个参数为可执行文件的名字。")]),s._v(" "),t("p",[s._v("从第二个开始是自己输入的参数。")]),s._v(" "),t("p",[s._v("指向字符串首字母地址。最后一个 argv[argc] 为 NULL")])])]),s._v(" "),t("h2",{attrs:{id:"_7-2-环境变量"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_7-2-环境变量"}},[s._v("#")]),s._v(" 7.2 环境变量")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("命令方式（临时的）")]),s._v(" "),t("p",[s._v("当前 shell 有效，新的 shell 中无效，重启也无效")])])]),s._v(" "),t("p",[s._v("命令行下输入变量值，再在当前 shell 下指定命令执行脚本")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("var "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("var1")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("12345")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nvar "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("var2")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("56789")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("hr"),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" print.sh\n")])])]),t("p",[s._v("输入以下内容")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#/bin/bash")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$var1")]),s._v('"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$var2")]),s._v('"')]),s._v("\n")])])]),t("p",[s._v("授权 + 执行")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v(" print.sh "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 此命令指定在当前 shell 执行此脚本 前面加了一个 . 能正常输出变量值")]),s._v("\n")])])]),t("p",[s._v("若用")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("./print.sh\n")])])]),t("p",[s._v("没有输出：这是启动一个新的 shell，这里说的环境变量算临时变量吧。新的 shell 中无效。程序执行空间问题。具体看操作系统，堆栈啥的。")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("函数方式（临时的）")]),s._v(" "),t("hr"),s._v(" "),t("p",[s._v("对当前进程有效")])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("配置文件修改（永久的，常用）")])]),s._v(" "),t("p",[s._v("这就是我们配置 Java Python 等常用的环境变量。")]),s._v(" "),t("p",[s._v("文件位于：？")])])]),s._v(" "),t("h2",{attrs:{id:"_7-3-时间管理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_7-3-时间管理"}},[s._v("#")]),s._v(" 7.3 时间管理")]),s._v(" "),t("h3",{attrs:{id:"_7-3-1-utc-介绍"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_7-3-1-utc-介绍"}},[s._v("#")]),s._v(" 7.3.1 UTC 介绍")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("time_t")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("从 1970 年 1 月 1 日 午夜开始计数的秒数值。")])]),s._v(" "),t("li",[t("p",[s._v("与系统直接进行交互的类型，UTC")])])])]),s._v(" "),t("li",[t("p",[s._v("结构体 struct tm")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("将 UTC 时间根据系统设置的时区进行分解")]),s._v(" "),t("p",[s._v("Java Python 等都遇到过")])])])]),s._v(" "),t("li",[t("p",[s._v("字符串")]),s._v(" "),t("p",[s._v("例如：Tue Jul ...")])])]),s._v(" "),t("h3",{attrs:{id:"_7-3-2-时间转换函数"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_7-3-2-时间转换函数"}},[s._v("#")]),s._v(" 7.3.2 时间转换函数")]),s._v(" "),t("div",{staticClass:"language-c extra-class"},[t("pre",{pre:!0,attrs:{class:"language-c"}},[t("code",[t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("include")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("<stdio.h>")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("include")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("<time.h>")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        time_t nowtime"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("char")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("nowtime2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("struct")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("tm")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("nowtime3"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("time")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("nowtime"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        nowtime2"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ctime")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("nowtime"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("printf")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"%s"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" nowtime2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        nowtime3"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("localtime")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("nowtime"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("printf")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v('"'),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v("d"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v("d"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v("d"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v("d\n               \n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),t("h2",{attrs:{id:"_7-4-错误代码"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_7-4-错误代码"}},[s._v("#")]),s._v(" 7.4 错误代码")]),s._v(" "),t("h3",{attrs:{id:"error"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#error"}},[s._v("#")]),s._v(" error")]),s._v(" "),t("ul",[t("li",[s._v("error number")])]),s._v(" "),t("p",[s._v("​\t引入头文件 error.h")]),s._v(" "),t("ul",[t("li",[s._v("strerror")]),s._v(" "),t("li",[s._v("perror")])]),s._v(" "),t("h1",{attrs:{id:"第八次课-文件-io"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#第八次课-文件-io"}},[s._v("#")]),s._v(" 第八次课 文件 IO")]),s._v(" "),t("h2",{attrs:{id:"_8-1-标准io-与文件-io"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_8-1-标准io-与文件-io"}},[s._v("#")]),s._v(" 8.1 标准IO 与文件 IO")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("标准 IO")]),s._v(" "),t("p",[s._v("语言提供的 IO，对平台提供的文件操作 API 有封装，换平台重新编译即可，可移植性强。")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("全缓冲")]),s._v(" "),t("p",[s._v("填满标准 IO 缓冲区再进行实际 IO。")])]),s._v(" "),t("li",[t("p",[s._v("行缓冲")]),s._v(" "),t("p",[s._v("遇到换行执行一次实际 IO，终端就是用的这个。")])])])]),s._v(" "),t("li",[t("p",[s._v("文件 IO")])])]),s._v(" "),t("h2",{attrs:{id:"_8-2-文件系统简介"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_8-2-文件系统简介"}},[s._v("#")]),s._v(" 8.2 文件系统简介")]),s._v(" "),t("h3",{attrs:{id:"文件系统类型"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#文件系统类型"}},[s._v("#")]),s._v(" 文件系统类型")]),s._v(" "),t("ul",[t("li",[s._v("Linux：ext2，ext3")]),s._v(" "),t("li",[s._v("Windows：NTFS，FAT")]),s._v(" "),t("li",[s._v("macOS：APFS")])]),s._v(" "),t("h3",{attrs:{id:"vfs-虚拟文件系统"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#vfs-虚拟文件系统"}},[s._v("#")]),s._v(" VFS 虚拟文件系统")]),s._v(" "),t("p",[s._v("作用：屏蔽不同文件系统的不同之处，对应用程序和用户透明的（他们感受不到文件系统的差异）。")]),s._v(" "),t("h4",{attrs:{id:"索引节点-inode"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#索引节点-inode"}},[s._v("#")]),s._v(" 索引节点 inode")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("Linux 采取 “按名存取” 访问文件。")])]),s._v(" "),t("li",[t("p",[s._v("文件分为两部分")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("索引节点 inode")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("记录文件的属性信息（不包括文件名）。可以用 ls -l 查看")])]),s._v(" "),t("li",[t("p",[s._v("数据块")]),s._v(" "),t("p",[s._v("文件具体内容")])])])])])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("目录文件")]),s._v(" 中保存着 "),t("strong",[s._v("文件名")]),s._v(" 和 "),t("strong",[s._v("索引节点")]),s._v(" inode 的对应关系。")])])]),s._v(" "),t("h3",{attrs:{id:"一个简单的-unix-文件系统组成"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#一个简单的-unix-文件系统组成"}},[s._v("#")]),s._v(" 一个简单的 Unix 文件系统组成")]),s._v(" "),t("ul",[t("li",[t("p",[t("strong",[s._v("引导块")]),s._v("：EFI 分区位于的地方")])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("超级块")])])]),s._v(" "),t("li",[t("p",[s._v("索引节点表 （ inode ）")])]),s._v(" "),t("li",[t("p",[s._v("数据块")])])]),s._v(" "),t("h3",{attrs:{id:"文件类型"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#文件类型"}},[s._v("#")]),s._v(" 文件类型")]),s._v(" "),t("ul",[t("li",[s._v("普通文件")]),s._v(" "),t("li",[s._v("目录文件")]),s._v(" "),t("li",[s._v("字符设备文件")]),s._v(" "),t("li",[s._v("块设备文件")]),s._v(" "),t("li",[t("font",{attrs:{color:"red"}},[s._v("FIFO 文件")])],1),s._v(" "),t("li",[s._v("符号链接文件")]),s._v(" "),t("li",[t("font",{attrs:{color:"red"}},[s._v("socket 套接字文件")])],1)]),s._v(" "),t("h3",{attrs:{id:"文件权限"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#文件权限"}},[s._v("#")]),s._v(" 文件权限")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("字母")]),s._v(" "),t("p",[s._v("r：read")]),s._v(" "),t("p",[s._v("w：write")]),s._v(" "),t("p",[s._v("x：execute 执行")]),s._v(" "),t("p",[t("code",[s._v("-")]),s._v(" ：无权限")])]),s._v(" "),t("li",[t("p",[s._v("数字")]),s._v(" "),t("p",[s._v("chmod 777 filename")])]),s._v(" "),t("li",[t("p",[s._v("宏")]),s._v(" "),t("p",[s._v("了解即可，用的不多。编程时常用 "),t("font",{attrs:{color:"red"}},[s._v("数字")]),s._v(" 表示权限")],1)])]),s._v(" "),t("h3",{attrs:{id:"访问文件的内核数据结构"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#访问文件的内核数据结构"}},[s._v("#")]),s._v(" 访问文件的内核数据结构")]),s._v(" "),t("p",[s._v("进程默认打开三个描述符")]),s._v(" "),t("h3",{attrs:{id:"常用系统调用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#常用系统调用"}},[s._v("#")]),s._v(" 常用系统调用")]),s._v(" "),t("h4",{attrs:{id:"_1-创建-打开-文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-创建-打开-文件"}},[s._v("#")]),s._v(" 1. 创建/打开 文件")]),s._v(" "),t("div",{staticClass:"language-c extra-class"},[t("pre",{pre:!0,attrs:{class:"language-c"}},[t("code",[t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("include")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("<sys/stat.h>")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("include")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("<fcntl.h>")])]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("open")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" 参数待补充 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])])]),t("ul",[t("li",[t("p",[s._v("打开已存在的文件时 perms 参数不用提供")])]),s._v(" "),t("li",[t("p",[s._v("新建文件需要 perms 参数")])]),s._v(" "),t("li",[t("p",[s._v("参数")]),s._v(" "),t("ul",[t("li",[s._v("path")]),s._v(" "),t("li",[s._v("flags：打开方式，可用或运算 "),t("code",[s._v("|")])]),s._v(" "),t("li",[s._v("perms")])])]),s._v(" "),t("li",[t("p",[s._v("返回值")]),s._v(" "),t("p",[s._v("用于判断文件打开出错没")]),s._v(" "),t("ul",[t("li",[s._v("-1：出错")]),s._v(" "),t("li",[s._v("0：成功")])])])]),s._v(" "),t("h4",{attrs:{id:"_2-关闭文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-关闭文件"}},[s._v("#")]),s._v(" 2. 关闭文件")]),s._v(" "),t("div",{staticClass:"language-c extra-class"},[t("pre",{pre:!0,attrs:{class:"language-c"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("close")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("fd"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("h4",{attrs:{id:"_3-练习"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-练习"}},[s._v("#")]),s._v(" 3. 练习")]),s._v(" "),t("p",[s._v("P73 例 4-4")]),s._v(" "),t("p",[s._v("fd.c")]),s._v(" "),t("div",{staticClass:"language-c extra-class"},[t("pre",{pre:!0,attrs:{class:"language-c"}},[t("code",[t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("include")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("<fcntl.h>")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" argc"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("char")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("argv"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" fd1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" fd2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" fd3"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    fd1 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("open")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"f1"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" O_RDWR"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    fd2 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("open")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"f2"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" O_RDWR"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    fd3 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("open")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"f3"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" O_RDWR"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    \n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("printf")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"fd1=%d\\n"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("fd1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("printf")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"fd2=%d\\n"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("fd2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("printf")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"fd3=%d\\n"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("fd3"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("close")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("fd1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("close")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("fd2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("close")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("fd3"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    \n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n")])])]),t("hr"),s._v(" "),t("p",[s._v("fd1.c")]),s._v(" "),t("div",{staticClass:"language-c extra-class"},[t("pre",{pre:!0,attrs:{class:"language-c"}},[t("code",[t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("include")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("<fcntl.h>")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" argc"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("char")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("argv"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" fd1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" fd2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" fd3"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    fd1 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("open")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"f1"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" O_RDWR"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    fd2 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("open")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"f2"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" O_RDWR"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("printf")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"fd1=%d\\n"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("fd1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("printf")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"fd2=%d\\n"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("fd2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("close")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("fd1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    fd3 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("open")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"f3"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" O_RDWR"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("printf")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"fd3=%d\\n"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("fd3"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("close")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("fd2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("close")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("fd3"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n")])])]),t("p",[s._v("创建文件 f1 f2 f3，再编译运行。")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("touch")]),s._v(" f1 f2 f3\n")])])]),t("p",[s._v("输出")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("fd：3 4 5")]),s._v(" "),t("ul",[t("li",[s._v("进程执行的时候打开了三个文件（中间没有关闭），进程描述符分别占用 3 4 5 号。")])])]),s._v(" "),t("li",[t("p",[s._v("fd1：3 4 3")]),s._v(" "),t("ul",[t("li",[s._v("进程执行的时候先打开了两个文件，进程描述符分别占用 3 4 号，先关闭了 fd1，再打开 fd3。系统调用 open 每次打开文件总是得到一个最小的可用文件描述符。")])])])]),s._v(" "),t("p",[s._v("具体解释看 P74。")]),s._v(" "),t("h4",{attrs:{id:"close-与-文件描述符"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#close-与-文件描述符"}},[s._v("#")]),s._v(" close 与 文件描述符")]),s._v(" "),t("p",[s._v("进程 open 文件时，系统有一张表记录进程打开的文件。")]),s._v(" "),t("p",[s._v("close 一个 fd，fd 指向的打开文件列表中引用计数器减1，如果减为0，不仅释放文件描述符，还释放该打开文件表项。")]),s._v(" "),t("h4",{attrs:{id:"_4-读文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-读文件"}},[s._v("#")]),s._v(" 4. 读文件")]),s._v(" "),t("div",{staticClass:"language-c extra-class"},[t("pre",{pre:!0,attrs:{class:"language-c"}},[t("code",[s._v("ssize_ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("read")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("fd"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" buf"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" nbytes"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("ul",[t("li",[t("p",[s._v("参数")]),s._v(" "),t("ul",[t("li",[s._v("fd：文件描述符")]),s._v(" "),t("li",[s._v("buf：读出的数据放在哪个缓冲区")]),s._v(" "),t("li",[s._v("nbytes：读取多少个字节")])])]),s._v(" "),t("li",[t("p",[s._v("返回值")]),s._v(" "),t("ul",[t("li",[s._v("-1：失败")]),s._v(" "),t("li",[s._v("成功：返回已读取的字符数。")])]),s._v(" "),t("p",[s._v("只通过返回值是否为 -1 判断读取失败。")])])]),s._v(" "),t("h4",{attrs:{id:"文件偏移量"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#文件偏移量"}},[s._v("#")]),s._v(" 文件偏移量")]),s._v(" "),t("p",[s._v("指针从文件头字符的移动量")]),s._v(" "),t("h4",{attrs:{id:"文件定位函数-lseek"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#文件定位函数-lseek"}},[s._v("#")]),s._v(" 文件定位函数 lseek")]),s._v(" "),t("div",{staticClass:"language-c extra-class"},[t("pre",{pre:!0,attrs:{class:"language-c"}},[t("code",[s._v("off_t "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("lseek")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" fd"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" off_t pos"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" whence"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("ul",[t("li",[t("p",[s._v("参数")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("fd")])]),s._v(" "),t("li",[t("p",[s._v("whence")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("SEEK_SET")]),s._v(" "),t("p",[s._v("以文件开始作为起点。")])])])]),s._v(" "),t("li",[t("p",[s._v("pos")]),s._v(" "),t("p",[s._v("可正可负 0 ，相对于 whence 的偏移量")])])])]),s._v(" "),t("li",[t("p",[s._v("返回值")]),s._v(" "),t("ul",[t("li",[s._v("-1")]),s._v(" "),t("li",[s._v("...")]),s._v(" "),t("li")])])]),s._v(" "),t("h4",{attrs:{id:"open-与文件描述符"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#open-与文件描述符"}},[s._v("#")]),s._v(" open 与文件描述符")]),s._v(" "),t("h4",{attrs:{id:"close-与文件描述符"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#close-与文件描述符"}},[s._v("#")]),s._v(" close 与文件描述符")]),s._v(" "),t("h4",{attrs:{id:"文件偏移量举例"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#文件偏移量举例"}},[s._v("#")]),s._v(" 文件偏移量举例")]),s._v(" "),t("p",[s._v("例 4-6 两次打开同一个文件进行操作")]),s._v(" "),t("p",[s._v("fileopen.c")]),s._v(" "),t("div",{staticClass:"language-c extra-class"},[t("pre",{pre:!0,attrs:{class:"language-c"}},[t("code",[t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("include")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("<stdio.h>")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("include")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("<stdlib.h>")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("include")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("<unistd.h>")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("include")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("<fcntl.h>")])]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" fd1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" fd2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" num"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("char")]),s._v(" buf"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    fd1 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("open")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"f1"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" O_RDWR "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" O_TRUNC"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("fd1 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("perror")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"open"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("exit")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("printf")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"fd1 is %d\\n"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" fd1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    fd2 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("open")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"f1"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" O_RDWR"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("fd2 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("perror")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"open"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("exit")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("printf")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"fd2 is %d\\n"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" fd2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    num "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("write")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("fd1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"hello world!"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("printf")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"fd1:write num=%d bytes into f1\\n"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" num"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    num "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("read")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("fd2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" buf"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    buf"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("num"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("printf")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"fd2:read %d bytes from f1: %s\\n"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" num"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" buf"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("close")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("fd1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("close")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("fd2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),t("hr"),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("gcc -o fileopen ./fileopen.c\n")])])]),t("p",[s._v("运行输出")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("fd1 is 3\nfd2 is 4\nfd1:write num=12 bytes into f1\nfd2:read 12 bytes from f1: hello world!\n")])])]),t("h4",{attrs:{id:"硬链接与符号链接-软链接"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#硬链接与符号链接-软链接"}},[s._v("#")]),s._v(" 硬链接与符号链接（软链接）")]),s._v(" "),t("h4",{attrs:{id:"文件权限修饰位-setuid"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#文件权限修饰位-setuid"}},[s._v("#")]),s._v(" 文件权限修饰位 - setuid")]),s._v(" "),t("p",[s._v("setuid 改变文件权限，让普通用户获得部分 root 用户才有的权限。")]),s._v(" "),t("h4",{attrs:{id:"dup-dup2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#dup-dup2"}},[s._v("#")]),s._v(" dup/dup2")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("重定向")])]),s._v(" "),t("li",[t("p",[s._v("两个函数")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("dup")])]),s._v(" "),t("li",[t("p",[s._v("dup2")])])])])])])}),[],!1,null,null,null);a.default=e.exports}}]);