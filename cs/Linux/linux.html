<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>linux | MarkDown Notes</title>
    <meta name="generator" content="VuePress 1.5.4">
    <link rel="&#39;stylesheet" href="/Note/styles/website.css">
    <meta name="description" content="">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="preload" href="/Note/assets/css/0.styles.c3b168f2.css" as="style"><link rel="preload" href="/Note/assets/js/app.8bf72d68.js" as="script"><link rel="preload" href="/Note/assets/js/4.ed70c863.js" as="script"><link rel="preload" href="/Note/assets/js/31.9f5f5098.js" as="script"><link rel="preload" href="/Note/assets/js/24.b41ee11a.js" as="script"><link rel="prefetch" href="/Note/assets/js/10.985735c1.js"><link rel="prefetch" href="/Note/assets/js/11.12240c9b.js"><link rel="prefetch" href="/Note/assets/js/12.2d68f34c.js"><link rel="prefetch" href="/Note/assets/js/13.489df819.js"><link rel="prefetch" href="/Note/assets/js/14.f3161fd3.js"><link rel="prefetch" href="/Note/assets/js/15.50043529.js"><link rel="prefetch" href="/Note/assets/js/16.5289788a.js"><link rel="prefetch" href="/Note/assets/js/17.69b240c7.js"><link rel="prefetch" href="/Note/assets/js/18.c56926fb.js"><link rel="prefetch" href="/Note/assets/js/19.eb8aca3c.js"><link rel="prefetch" href="/Note/assets/js/2.051bcbb1.js"><link rel="prefetch" href="/Note/assets/js/20.4fed2f5b.js"><link rel="prefetch" href="/Note/assets/js/21.67006912.js"><link rel="prefetch" href="/Note/assets/js/22.a610bed2.js"><link rel="prefetch" href="/Note/assets/js/23.deb6a7e0.js"><link rel="prefetch" href="/Note/assets/js/25.d242519f.js"><link rel="prefetch" href="/Note/assets/js/26.9632d16e.js"><link rel="prefetch" href="/Note/assets/js/27.fb333e12.js"><link rel="prefetch" href="/Note/assets/js/28.b5c7beef.js"><link rel="prefetch" href="/Note/assets/js/29.7d817c28.js"><link rel="prefetch" href="/Note/assets/js/3.ae14be89.js"><link rel="prefetch" href="/Note/assets/js/30.59e7995d.js"><link rel="prefetch" href="/Note/assets/js/32.bed5e64e.js"><link rel="prefetch" href="/Note/assets/js/33.a7e71aa4.js"><link rel="prefetch" href="/Note/assets/js/34.3fe79d7e.js"><link rel="prefetch" href="/Note/assets/js/35.b8116545.js"><link rel="prefetch" href="/Note/assets/js/36.4f4bee68.js"><link rel="prefetch" href="/Note/assets/js/37.562bed3c.js"><link rel="prefetch" href="/Note/assets/js/38.45d6f8c0.js"><link rel="prefetch" href="/Note/assets/js/39.b24dd04d.js"><link rel="prefetch" href="/Note/assets/js/40.e940eb18.js"><link rel="prefetch" href="/Note/assets/js/41.512e67ff.js"><link rel="prefetch" href="/Note/assets/js/42.4e856ef8.js"><link rel="prefetch" href="/Note/assets/js/43.44db7021.js"><link rel="prefetch" href="/Note/assets/js/44.a2d2291a.js"><link rel="prefetch" href="/Note/assets/js/45.9ab624e9.js"><link rel="prefetch" href="/Note/assets/js/46.fa7cc510.js"><link rel="prefetch" href="/Note/assets/js/47.82e5276e.js"><link rel="prefetch" href="/Note/assets/js/48.89f4ef50.js"><link rel="prefetch" href="/Note/assets/js/49.d0d5e875.js"><link rel="prefetch" href="/Note/assets/js/5.f1bdb6df.js"><link rel="prefetch" href="/Note/assets/js/50.2ff95f91.js"><link rel="prefetch" href="/Note/assets/js/51.d96a497c.js"><link rel="prefetch" href="/Note/assets/js/52.ef6293e9.js"><link rel="prefetch" href="/Note/assets/js/6.c315504a.js"><link rel="prefetch" href="/Note/assets/js/7.2c04b28b.js"><link rel="prefetch" href="/Note/assets/js/8.ae0aa254.js"><link rel="prefetch" href="/Note/assets/js/9.320a4c1f.js">
    <link rel="stylesheet" href="/Note/assets/css/0.styles.c3b168f2.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/Note/" class="home-link router-link-active"><!----> <span class="site-name">MarkDown Notes</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/Note/Navigate.html" class="nav-link">
  导航页
</a></div><div class="nav-item"><a href="/Note/exam/examtime.html" class="nav-link">
  课程与考试
</a></div> <div class="nav-item"><a role="button" aria-label="Switch to light mode" class="nav-link"><span>Switch theme</span></a></div> <a href="https://github.com/chengziqaq/Note" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/Note/Navigate.html" class="nav-link">
  导航页
</a></div><div class="nav-item"><a href="/Note/exam/examtime.html" class="nav-link">
  课程与考试
</a></div> <div class="nav-item"><a role="button" aria-label="Switch to light mode" class="nav-link"><span>Switch theme</span></a></div> <a href="https://github.com/chengziqaq/Note" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/Note/Navigate.html" class="sidebar-link">导航</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>前端</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>后端</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Java</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Python</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>C</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>计算机专业课</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Linux</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Note/cs/Linux/linux.html" aria-current="page" class="active sidebar-link">Linux</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Note/cs/Linux/linux.html#文件系统" class="sidebar-link">文件系统</a></li><li class="sidebar-sub-header"><a href="/Note/cs/Linux/linux.html#常用命令" class="sidebar-link">常用命令</a></li><li class="sidebar-sub-header"><a href="/Note/cs/Linux/linux.html#系统管理命令" class="sidebar-link">系统管理命令</a></li><li class="sidebar-sub-header"><a href="/Note/cs/Linux/linux.html#用户管理" class="sidebar-link">用户管理</a></li><li class="sidebar-sub-header"><a href="/Note/cs/Linux/linux.html#linux-设备管理" class="sidebar-link">Linux 设备管理</a></li><li class="sidebar-sub-header"><a href="/Note/cs/Linux/linux.html#磁盘和分区管理" class="sidebar-link">磁盘和分区管理</a></li><li class="sidebar-sub-header"><a href="/Note/cs/Linux/linux.html#进程管理" class="sidebar-link">进程管理</a></li><li class="sidebar-sub-header"><a href="/Note/cs/Linux/linux.html#日志" class="sidebar-link">日志</a></li><li class="sidebar-sub-header"><a href="/Note/cs/Linux/linux.html#shell-编程" class="sidebar-link">shell 编程</a></li><li class="sidebar-sub-header"><a href="/Note/cs/Linux/linux.html#shell-脚本" class="sidebar-link">shell 脚本</a></li><li class="sidebar-sub-header"><a href="/Note/cs/Linux/linux.html#shell-变量" class="sidebar-link">shell 变量</a></li><li class="sidebar-sub-header"><a href="/Note/cs/Linux/linux.html#or-运算" class="sidebar-link">OR 运算</a></li><li class="sidebar-sub-header"><a href="/Note/cs/Linux/linux.html#计算" class="sidebar-link">计算</a></li><li class="sidebar-sub-header"><a href="/Note/cs/Linux/linux.html#if-script" class="sidebar-link">if_script:</a></li><li class="sidebar-sub-header"><a href="/Note/cs/Linux/linux.html#_6-1-gcc" class="sidebar-link">6.1 gcc</a></li><li class="sidebar-sub-header"><a href="/Note/cs/Linux/linux.html#_6-2-makefile" class="sidebar-link">6.2 Makefile</a></li><li class="sidebar-sub-header"><a href="/Note/cs/Linux/linux.html#_6-4-gdb-调试器" class="sidebar-link">6.4 GDB 调试器</a></li><li class="sidebar-sub-header"><a href="/Note/cs/Linux/linux.html#_6-5-库-lib" class="sidebar-link">6.5 库 lib</a></li><li class="sidebar-sub-header"><a href="/Note/cs/Linux/linux.html#_7-1-命令行参数" class="sidebar-link">7.1 命令行参数</a></li><li class="sidebar-sub-header"><a href="/Note/cs/Linux/linux.html#_7-2-环境变量" class="sidebar-link">7.2 环境变量</a></li><li class="sidebar-sub-header"><a href="/Note/cs/Linux/linux.html#_7-3-时间管理" class="sidebar-link">7.3 时间管理</a></li><li class="sidebar-sub-header"><a href="/Note/cs/Linux/linux.html#_7-4-错误代码" class="sidebar-link">7.4 错误代码</a></li><li class="sidebar-sub-header"><a href="/Note/cs/Linux/linux.html#_8-1-标准io-与文件-io" class="sidebar-link">8.1 标准IO 与文件 IO</a></li><li class="sidebar-sub-header"><a href="/Note/cs/Linux/linux.html#_8-2-文件系统简介" class="sidebar-link">8.2 文件系统简介</a></li></ul></li><li><a href="/Note/cs/Linux/shell.html" class="sidebar-link">shell 编程</a></li><li><a href="/Note/cs/Linux/Git/git.html" class="sidebar-link">git</a></li><li><a href="/Note/cs/Linux/Git/git和Github的基本使用.html" class="sidebar-link">git 和 Github 的基本使用</a></li><li><a href="/Note/cs/Linux/networkProgram.html" class="sidebar-link">Linux 网络编程</a></li><li><a href="/Note/cs/Linux/LinuxNetworkProgramExperiment.html" class="sidebar-link">Linux 网络编程上机实验</a></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Docker</span> <span class="arrow right"></span></p> <!----></section></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>大三上</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>桌面应用开发</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Android</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>数据库</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>学习方法</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>网络安全</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-succinct-content content__default"><h1 id="linux"><a href="#linux" class="header-anchor">#</a> linux</h1> <h2 id="文件系统"><a href="#文件系统" class="header-anchor">#</a> 文件系统</h2> <h3 id="目录"><a href="#目录" class="header-anchor">#</a> 目录</h3> <ol><li>bin: 二进制可执行文件</li> <li>home: 用户目录</li> <li>lib: 共享库目录</li> <li>etc: 系统管理和配置文件, host 和 dns 密码等都在这</li> <li>dev: 设备相关的</li> <li>tmp: 临时文件, 重启后里面的文件消失</li> <li>usr: 软件一般安装在这里</li></ol> <h3 id="文件链接"><a href="#文件链接" class="header-anchor">#</a> 文件链接</h3> <p>文件链接类似于 windows 下面的快捷方式</p> <h3 id="路径"><a href="#路径" class="header-anchor">#</a> 路径</h3> <ul><li>相对路径</li> <li>绝对路径</li></ul> <h2 id="常用命令"><a href="#常用命令" class="header-anchor">#</a> 常用命令</h2> <h3 id="grep"><a href="#grep" class="header-anchor">#</a> grep</h3> <p>Linux grep 命令用于查找文件里符合条件的字符串</p> <p>grep [OPTION] &quot;查找的字符串&quot; 查找的文件名</p> <p>参数</p> <ul><li>-n: 显示找到的文本的行数</li> <li>-i: 忽略大小写</li></ul> <h3 id="cp"><a href="#cp" class="header-anchor">#</a> cp</h3> <p>cp [OPTION] 源文件 目标文件</p> <p>使用通配符:</p> <p>cp hello* ./dir1</p> <p>将以 hello 开头的所有文件复制到当前目录下 dir1 目录下</p> <h3 id="rm"><a href="#rm" class="header-anchor">#</a> rm</h3> <p>参数</p> <ul><li><p>-f</p> <p>强制删除 不给提示</p></li> <li><p>-i</p></li> <li><p>-r</p></li></ul> <h3 id="find"><a href="#find" class="header-anchor">#</a> find</h3> <p>find [路径][表达式]</p> <p>表达式</p> <p>-name 文件/目录?名字</p> <p>-type d</p> <p>找目录</p> <p>-type</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">find</span> ./dir5 -name *.c
</code></pre></div><p>找到 dir5 下的所有的文件名带.c 的文件</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">find</span> <span class="token builtin class-name">.</span> -type d
</code></pre></div><h3 id="tar"><a href="#tar" class="header-anchor">#</a> tar</h3> <p>tar -czf 打包文件名.tar.gz 目录</p> <p>tar -zxvf 需要解包的文件名字</p> <h3 id="gzip"><a href="#gzip" class="header-anchor">#</a> gzip</h3> <p>解压:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">gzip</span> -d 压缩文件名
</code></pre></div><h3 id="chmod"><a href="#chmod" class="header-anchor">#</a> chmod</h3> <p>chmod [who][opt] [mode] 文件名</p> <p>who:</p> <p>u: 文件所有者</p> <p>g: 本人所在. 组成员</p> <p>o: 系统中的其他的用户</p> <p>a: 所有用户</p> <p>opt:</p> <p>+: 增加</p> <p>-: 减少</p> <p>=: 使存储权限等于</p> <p>mode 表示权限:</p> <p>r: 读权限</p> <p>w: 写权限</p> <p>x: 执行权限</p> <p>对目录使用需要 -R 选项</p> <p>取消本用户对 chmodcmd 目录的读权限</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">chmod</span> u-r chmodcmd/
</code></pre></div><h3 id="ln"><a href="#ln" class="header-anchor">#</a> ln</h3> <p>建立符号链接(类似于 windows 快捷方式)</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">ln</span> -s 源文件 符号链接<span class="token punctuation">(</span>快捷方式<span class="token punctuation">)</span>名称
</code></pre></div><h1 id="第三次课"><a href="#第三次课" class="header-anchor">#</a> 第三次课</h1> <h2 id="系统管理命令"><a href="#系统管理命令" class="header-anchor">#</a> 系统管理命令</h2> <h3 id="shutdown"><a href="#shutdown" class="header-anchor">#</a> shutdown</h3> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">shutdown</span> -h now //立即关机
</code></pre></div><div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">shutdown</span> +5 //五分钟后关机
</code></pre></div><div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">shutdown</span> -r now/23:59 // 现在/23:59分 关闭系统再重启
</code></pre></div><h3 id="halt"><a href="#halt" class="header-anchor">#</a> halt</h3> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">halt</span> -f //强制关机, 危险
</code></pre></div><div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">halt</span> -p //关机
</code></pre></div><h3 id="reboot"><a href="#reboot" class="header-anchor">#</a> reboot</h3> <p>立刻重启</p> <h2 id="用户管理"><a href="#用户管理" class="header-anchor">#</a> 用户管理</h2> <p>用户的增删改查, 暂时用不到, 不做笔记</p> <h3 id="切换用户命令-sudo"><a href="#切换用户命令-sudo" class="header-anchor">#</a> 切换用户命令 sudo</h3> <p>切换用户是 su(switch user)</p> <p>简写: sudo</p> <h2 id="linux-设备管理"><a href="#linux-设备管理" class="header-anchor">#</a> Linux 设备管理</h2> <p>所有设备皆文件</p> <h3 id="设备标识"><a href="#设备标识" class="header-anchor">#</a> 设备标识</h3> <h4 id="主设备号"><a href="#主设备号" class="header-anchor">#</a> 主设备号</h4> <ul><li>tty: 终端设备</li> <li>lp: 打印机</li> <li>hd: IDE 硬盘</li> <li>sd: SCSI 硬盘</li></ul> <h4 id="次设备号"><a href="#次设备号" class="header-anchor">#</a> 次设备号</h4> <p>如 hda hdb tty0 lp0</p> <p>用于区分多个设备, 比如多个硬. 打印机</p> <h2 id="磁盘和分区管理"><a href="#磁盘和分区管理" class="header-anchor">#</a> 磁盘和分区管理</h2> <h3 id="fdisk"><a href="#fdisk" class="header-anchor">#</a> fdisk</h3> <h2 id="进程管理"><a href="#进程管理" class="header-anchor">#</a> 进程管理</h2> <ul><li><p>Linux 系统上所有运行的东西都可以称为进程</p></li> <li><p>进程三种状态: <strong>运行态</strong> <strong>就绪态</strong> <strong>阻塞态</strong></p></li> <li><p>进程大致可以分为: <strong>系统进程</strong> <strong>用户进程</strong></p></li></ul> <h3 id="命令"><a href="#命令" class="header-anchor">#</a> 命令</h3> <p>进程查看</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">ps</span> aux
</code></pre></div><ul><li><p>at 命令</p> <p>at -f /home/user/pwd_script 03:15</p></li> <li><p>wait 命令</p></li> <li><p>kill [-s 信号 | -p][-a] 进程号</p> <p>kill -l [信号]</p></li></ul> <h2 id="日志"><a href="#日志" class="header-anchor">#</a> 日志</h2> <ul><li><p>/var/log/dmesg</p> <p>内核启动信息</p></li> <li><p>/var/log/messages</p> <p>内核错误和应用程序错误</p></li> <li><p>/var/log/wtmp 和 /var/run/utmp</p> <p>用户登录和操作的记录</p></li></ul> <h1 id="第四次课"><a href="#第四次课" class="header-anchor">#</a> 第四次课</h1> <h2 id="shell-编程"><a href="#shell-编程" class="header-anchor">#</a> shell 编程</h2> <h3 id="输入输出重定向"><a href="#输入输出重定向" class="header-anchor">#</a> 输入输出重定向</h3> <ul><li><p>输入: 文件中读入</p> <p>小于符号 &lt;</p></li> <li><p>输出: &gt; 符号. 可以将控制台的内容输出到文件</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">ls</span> <span class="token operator">&gt;</span> <span class="token number">1</span>.txt
</code></pre></div><p>追加: &gt;&gt; 在源文件后增加内容</p> <p>用一个 &gt; 会覆盖原文件</p></li> <li><p>错误信息输出</p> <p>cmd [参数] 2 文件名</p></li></ul> <h3 id="管道命令"><a href="#管道命令" class="header-anchor">#</a> 管道命令</h3> <p>命令的输出做另一个命令的输入 符号 | 表示</p> <h3 id="shell-基础-特殊字符"><a href="#shell-基础-特殊字符" class="header-anchor">#</a> shell 基础 特殊字符</h3> <ol><li><p>通配符</p> <div class="language-bash extra-class"><pre class="language-bash"><code>* 任何字符串
? 单个字符
<span class="token punctuation">[</span><span class="token punctuation">]</span> 字符组中的一部分
</code></pre></div></li> <li><p>引号</p> <div class="language-bash extra-class"><pre class="language-bash"><code>单引号: 特殊字符变为普通字符
双引号: 除 $ <span class="token punctuation">\</span> '  &quot; 这几个依然是特殊字符 其他字符变为普通字符
</code></pre></div><p>$ 变量命名</p></li> <li><p>反引号</p> <p>反引号括起来的会被 shell 解释为命令 并且首先执行 并用标准输出结果代替反引号里的内容</p></li> <li><p>注释</p> <h1 id=""><a href="#" class="header-anchor">#</a></h1></li> <li><p>别名</p> <p>alias alias-name='origin cmd'</p></li></ol> <h2 id="shell-脚本"><a href="#shell-脚本" class="header-anchor">#</a> shell 脚本</h2> <p>shell 是按行一条接着一条的解释并执行 shell 脚本中的命令</p> <h3 id="命令执行"><a href="#命令执行" class="header-anchor">#</a> 命令执行</h3> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">sh</span> 脚本名字
<span class="token function">bash</span> 脚本名字
./脚本名字 /*当前路径下*/
</code></pre></div><p>sh 方法不需要脚本有执行权限</p> <p>./ 方法必须有</p> <ul><li>sh 启动新的 shell 执行脚本</li> <li>./ 当前 shell 执行脚本</li></ul> <h2 id="shell-变量"><a href="#shell-变量" class="header-anchor">#</a> shell 变量</h2> <p>一个 shell 终端就是一个进程</p> <h3 id="shift"><a href="#shift" class="header-anchor">#</a> shift</h3> <p>使命令行输入的位置参数左移</p> <ul><li>env 命令查看当前 shell 环境变量</li> <li>用户提示符 # root $普通用户</li></ul> <h3 id="read-变量名-读入键盘输入-赋值给变量"><a href="#read-变量名-读入键盘输入-赋值给变量" class="header-anchor">#</a> read [变量名]: 读入键盘输入 赋值给变量</h3> <h3 id="echo"><a href="#echo" class="header-anchor">#</a> echo</h3> <p>echo 默认换行</p> <h3 id="export"><a href="#export" class="header-anchor">#</a> export</h3> <p>父 shell 导入 变量给子 shell</p> <ul><li><p>例子</p> <ul><li><p>父 shell 文件</p> <p>father.sh</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token shebang important">#! /bin/bash</span>
<span class="token assign-left variable">var1</span><span class="token operator">=</span><span class="token string">&quot;the first var&quot;</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">var2</span><span class="token operator">=</span><span class="token string">&quot;the second var&quot;</span> //export命令 不加这个不会输出到son.sh shell中
<span class="token function">sh</span> son.sh //运行之后会运行son.sh脚本的内容. <span class="token function">sh</span> 后面的是子shell文件名 类似函数传参<span class="token punctuation">(</span>这样说不是特别准确<span class="token punctuation">)</span>. 不过这是在两个文件中传递（说成在两个shell中传递更准）
</code></pre></div></li> <li><p>子 shell 文件</p> <p>son.sh</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token shebang important">#! /bin/bash</span>
<span class="token builtin class-name">echo</span> <span class="token variable">$var1</span>
<span class="token builtin class-name">echo</span> <span class="token variable">$var2</span>
</code></pre></div></li> <li><p>运行 father.sh</p> <p>命令: sh father.sh</p> <p>运行之后会运行 son.sh 脚本的内容.</p> <p>输出为:</p> <div class="language- extra-class"><pre class="language-text"><code>			//由于 var1没有被传入 输出为空
the second var //var2传递过来了 有输出内容
</code></pre></div></li></ul></li></ul> <h1 id="第五次课"><a href="#第五次课" class="header-anchor">#</a> 第五次课</h1> <h2 id="or-运算"><a href="#or-运算" class="header-anchor">#</a> OR 运算</h2> <p>|| 连接多条命令, 依次执行, 若有一条指令执行返回值为 false, 后面的指令就停止执行.</p> <h2 id="计算"><a href="#计算" class="header-anchor">#</a> 计算</h2> <ul><li><p>expr</p></li> <li><p>let</p> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token builtin class-name">let</span> <span class="token string">&quot;a=2&quot;</span> <span class="token string">&quot;b=3&quot;</span>
<span class="token builtin class-name">let</span> <span class="token assign-left variable">c</span><span class="token operator">=</span>a*b
</code></pre></div><p>使用 let 命令时, 变量前的</p></li></ul> <h2 id="if-script"><a href="#if-script" class="header-anchor">#</a> if_script:</h2> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token comment">#! bin/bsah</span>
<span class="token comment"># this script is about if</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot; abc is the username? input yes or no&quot;</span>
<span class="token builtin class-name">read</span> name
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token string">&quot;<span class="token variable">$name</span>&quot;</span><span class="token operator">=</span><span class="token string">&quot;yes&quot;</span> <span class="token punctuation">]</span>
<span class="token keyword">then</span>
	<span class="token builtin class-name">echo</span> <span class="token string">&quot;hello abc!&quot;</span>
<span class="token keyword">else</span>
	<span class="token builtin class-name">echo</span> <span class="token string">&quot;abc is not your name&quot;</span>
<span class="token keyword">fi</span>
<span class="token builtin class-name">exit</span> <span class="token number">0</span>
</code></pre></div><div class="language-sh extra-class"><pre class="language-sh"><code><span class="token shebang important">#! /bin/bash</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;yes or no&quot;</span>
<span class="token builtin class-name">read</span> name
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token string">&quot;<span class="token variable">$name</span>&quot;</span> <span class="token operator">=</span> <span class="token string">&quot;yes&quot;</span> <span class="token punctuation">]</span>
<span class="token keyword">then</span>
        <span class="token builtin class-name">echo</span> <span class="token string">&quot;hello abc!&quot;</span>
<span class="token keyword">elif</span> <span class="token punctuation">[</span> <span class="token string">&quot;<span class="token variable">$name</span>&quot;</span> <span class="token operator">=</span> <span class="token string">&quot;no&quot;</span> <span class="token punctuation">]</span>
<span class="token keyword">then</span>
        <span class="token builtin class-name">echo</span> <span class="token string">&quot;you inputed no&quot;</span>
<span class="token keyword">else</span>
        <span class="token builtin class-name">echo</span> <span class="token string">&quot;error&quot;</span>
<span class="token keyword">fi</span>
<span class="token builtin class-name">exit</span> <span class="token number">0</span>

</code></pre></div><div class="language-sh extra-class"><pre class="language-sh"><code><span class="token comment">#! bin/bash</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;enter the week number&quot;</span>
<span class="token builtin class-name">read</span> number
<span class="token keyword">case</span> <span class="token variable">$number</span> <span class="token keyword">in</span>
        <span class="token number">1</span><span class="token punctuation">)</span> <span class="token builtin class-name">echo</span> <span class="token string">&quot;zhou yi&quot;</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
        <span class="token number">2</span><span class="token punctuation">)</span> <span class="token builtin class-name">echo</span> <span class="token string">&quot;er&quot;</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
        <span class="token number">3</span><span class="token punctuation">)</span> <span class="token builtin class-name">echo</span> <span class="token string">&quot;san&quot;</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
        *<span class="token punctuation">)</span> <span class="token builtin class-name">echo</span> <span class="token string">&quot;number must between 1 and 7&quot;</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token keyword">esac</span>

</code></pre></div><h1 id="第六次课"><a href="#第六次课" class="header-anchor">#</a> 第六次课</h1> <h2 id="_6-1-gcc"><a href="#_6-1-gcc" class="header-anchor">#</a> 6.1 gcc</h2> <div class="language-shell extra-class"><pre class="language-shell"><code>gcc -o 程序名字 源文件.c 头文件.h <span class="token punctuation">..</span>.
</code></pre></div><p>头文件在其他目录</p> <div class="language-shell extra-class"><pre class="language-shell"><code>gcc -o -I头文件目录名 程序名字 源文件.c 头文件.h <span class="token punctuation">..</span>.
</code></pre></div><p>例子</p> <div class="language-shell extra-class"><pre class="language-shell"><code>gcc -o -I./head 程序名字 源文件.c 头文件.h <span class="token punctuation">..</span>.
</code></pre></div><p>当前文件夹下的 head 文件夹下寻找头文件</p> <h2 id="_6-2-makefile"><a href="#_6-2-makefile" class="header-anchor">#</a> 6.2 Makefile</h2> <p>make 命令会检测一个大型程序, 代码改变后哪些部分需要重新编译.</p> <p>简单来说: gcc 命令的集合</p> <p>流程</p> <ol><li>读入 <strong>Makefile</strong> 文件</li> <li>初始化变量</li> <li>待补充</li></ol> <h3 id="_6-2-1-内容"><a href="#_6-2-1-内容" class="header-anchor">#</a> 6.2.1 内容</h3> <ol><li><p>显式规则</p></li> <li><p>隐含规则</p> <p>makefile 自带的规则</p></li></ol> <h4 id="_6-2-1-1-显示-格式"><a href="#_6-2-1-1-显示-格式" class="header-anchor">#</a> 6.2.1.1 显示 格式</h4> <p>目标: 依赖</p> <p>命令</p> <p>例子</p> <ol><li><p>新建 makefile 文件</p> <p>vi makefile</p></li></ol> <div class="language-makefile extra-class"><pre class="language-makefile"><code><span class="token symbol">hello</span><span class="token punctuation">:</span> hello.c
	gcc -o hello hello.c
</code></pre></div><p>hello(可执行文件) 依赖于 hello.c(源文件)</p> <p>下面的命令时编译命令.</p> <ol><li>vi hello.c</li></ol> <div class="language-C extra-class"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
     <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;hello world changed \n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>执行命令 make 可以自动编译为可执行文件</p> <p>修改 hello.c 再执行 make</p> <h3 id="_6-3-命令"><a href="#_6-3-命令" class="header-anchor">#</a> 6.3 命令</h3> <h4 id="clean"><a href="#clean" class="header-anchor">#</a> clean</h4> <p>clean:</p> <p>rm ...</p> <p>清理文件</p> <h4 id="make"><a href="#make" class="header-anchor">#</a> make</h4> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">make</span> 可执行文件名字
</code></pre></div><p>只对 这个可执行文件执行 make 命令</p> <h3 id="_6-4-变量"><a href="#_6-4-变量" class="header-anchor">#</a> 6.4 变量</h3> <p>变量可代表命令</p> <ol><li><p>大小写敏感</p></li> <li><p>内部定义</p> <ul><li><p>$@</p> <p>目标文件</p></li> <li><p>$^</p> <p>所有依赖文件</p></li> <li><p>$&lt;</p> <p>第一个依赖文件</p></li></ul></li></ol> <p>例子</p> <div class="language-makefile extra-class"><pre class="language-makefile"><code><span class="token comment">#makefile</span>

</code></pre></div><h3 id="_6-5-隐含规则"><a href="#_6-5-隐含规则" class="header-anchor">#</a> 6.5 隐含规则</h3> <p>C 程序 .o 文件由 .c 生成</p> <p>C++ 由 .cc 生成</p> <p>将 gcc 名字设置为变量, 方便以后切换版本</p> <p>隐含条件简化命令</p> <div class="language-makefile extra-class"><pre class="language-makefile"><code><span class="token symbol">main.o</span><span class="token punctuation">:</span> main.c **.h
</code></pre></div><h3 id="_6-3-makefile-使用"><a href="#_6-3-makefile-使用" class="header-anchor">#</a> 6.3 Makefile 使用</h3> <h4 id="make-执行过程"><a href="#make-执行过程" class="header-anchor">#</a> make 执行过程</h4> <ul><li><p>查找顺序</p> <ol><li><p>GNUmake</p> <p>...</p> <p>makefile</p></li></ol></li></ul> <h2 id="_6-4-gdb-调试器"><a href="#_6-4-gdb-调试器" class="header-anchor">#</a> 6.4 GDB 调试器</h2> <p>编译错误</p> <p>运行错误时用 GDB 调试</p> <h2 id="_6-5-库-lib"><a href="#_6-5-库-lib" class="header-anchor">#</a> 6.5 库 lib</h2> <h3 id="定义"><a href="#定义" class="header-anchor">#</a> 定义</h3> <h3 id="库函数"><a href="#库函数" class="header-anchor">#</a> 库函数：</h3> <p>系统提供，供程序员调用，完成特定功能的函数，一般是 .o 文件。</p> <h3 id="静态库"><a href="#静态库" class="header-anchor">#</a> 静态库</h3> <ul><li>一般以 .a 结尾。</li> <li>编译时：库函数合并在可执行文件中</li> <li>执行时：提供程序即可</li> <li>可执行文件会变大</li></ul> <h3 id="共享库"><a href="#共享库" class="header-anchor">#</a> 共享库</h3> <ul><li><p>以 .so .so.x 结尾</p></li> <li><p>其他性质与静态库相反</p> <p>编译不加入</p> <p>执行时要提供库文件</p> <p>执行文件较小。多个可执行文件可以共享，适合大型程序。</p></li></ul> <h3 id="制作静态库"><a href="#制作静态库" class="header-anchor">#</a> 制作静态库</h3> <p>gcc 生成 .o 文件 再用 ar -rc 打包</p> <div class="language-shell extra-class"><pre class="language-shell"><code>gcc -c stack.c
</code></pre></div><hr> <div class="language-shell extra-class"><pre class="language-shell"><code>ar -rc libstack.a stack.o
</code></pre></div><p>源文件 stack.c</p> <p>gcc 命令生成 stack.o 文件</p> <p>打包后的静态库：libstack.a</p> <h3 id="使用静态库"><a href="#使用静态库" class="header-anchor">#</a> 使用静态库</h3> <p>编译 main.c 时用 -L 参数加入静态库</p> <div class="language-shell extra-class"><pre class="language-shell"><code>gcc -o main main.c -L./ -lstack
</code></pre></div><p>然后运行 main</p> <h3 id="动态库"><a href="#动态库" class="header-anchor">#</a> 动态库</h3> <h4 id="制作"><a href="#制作" class="header-anchor">#</a> 制作</h4> <div class="language-shell extra-class"><pre class="language-shell"><code>gcc stack.c -fPIC -shared -o libstack2.so
</code></pre></div><p>shared：共享库</p> <p>-fPIC： f 为选项 PIC 为参数：位置无关代码。（待修改）</p> <h3 id="使用"><a href="#使用" class="header-anchor">#</a> 使用</h3> <p>编译 main.c 加 L 参数，和使用静态库命令一样</p> <div class="language-shell extra-class"><pre class="language-shell"><code>gcc -o main2 main.c -L./ -lstack2
</code></pre></div><p>main2 中没有共享库的代码。只复制 main2 给别人不能直接执行，除非同时提供库文件。</p> <h3 id="添加共享库"><a href="#添加共享库" class="header-anchor">#</a> 添加共享库</h3> <p>设置环境变量，告诉系统动态库在哪里。</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token builtin class-name">export</span> <span class="token assign-left variable">LD_LIBRARY_PATH</span><span class="token operator">=</span>./<span class="token punctuation">;</span> <span class="token comment"># 修改共享库路径环境变量为当前目录</span>
<span class="token variable">$LD_LIBRARY_PATH</span> <span class="token comment"># 查看环境变量</span>
</code></pre></div><h1 id="第七次课"><a href="#第七次课" class="header-anchor">#</a> 第七次课</h1> <h2 id="_7-1-命令行参数"><a href="#_7-1-命令行参数" class="header-anchor">#</a> 7.1 命令行参数</h2> <p>传入给 main 函数</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><ul><li><p>argc</p> <p>命令行参数个数，执行程序名称算一个 + 用户输入的参数个数</p></li> <li><p>*argv[]</p> <p>第一个参数为可执行文件的名字。</p> <p>从第二个开始是自己输入的参数。</p> <p>指向字符串首字母地址。最后一个 argv[argc] 为 NULL</p></li></ul> <h2 id="_7-2-环境变量"><a href="#_7-2-环境变量" class="header-anchor">#</a> 7.2 环境变量</h2> <ul><li><p>命令方式（临时的）</p> <p>当前 shell 有效，新的 shell 中无效，重启也无效</p></li></ul> <p>命令行下输入变量值，再在当前 shell 下指定命令执行脚本</p> <div class="language-shell extra-class"><pre class="language-shell"><code>var <span class="token assign-left variable">var1</span><span class="token operator">=</span><span class="token number">12345</span><span class="token punctuation">;</span>
var <span class="token assign-left variable">var2</span><span class="token operator">=</span><span class="token number">56789</span><span class="token punctuation">;</span>
</code></pre></div><hr> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">vi</span> print.sh
</code></pre></div><p>输入以下内容</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment">#/bin/bash</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">$var1</span>&quot;</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">$var2</span>&quot;</span>
</code></pre></div><p>授权 + 执行</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token builtin class-name">.</span> print.sh <span class="token comment"># 此命令指定在当前 shell 执行此脚本 前面加了一个 . 能正常输出变量值</span>
</code></pre></div><p>若用</p> <div class="language-shell extra-class"><pre class="language-shell"><code>./print.sh
</code></pre></div><p>没有输出：这是启动一个新的 shell，这里说的环境变量算临时变量吧。新的 shell 中无效。程序执行空间问题。具体看操作系统，堆栈啥的。</p> <ul><li><p>函数方式（临时的）</p> <hr> <p>对当前进程有效</p></li> <li><p><strong>配置文件修改（永久的，常用）</strong></p> <p>这就是我们配置 Java Python 等常用的环境变量。</p> <p>文件位于：？</p></li></ul> <h2 id="_7-3-时间管理"><a href="#_7-3-时间管理" class="header-anchor">#</a> 7.3 时间管理</h2> <h3 id="_7-3-1-utc-介绍"><a href="#_7-3-1-utc-介绍" class="header-anchor">#</a> 7.3.1 UTC 介绍</h3> <ul><li><p>time_t</p> <ul><li><p>从 1970 年 1 月 1 日 午夜开始计数的秒数值。</p></li> <li><p>与系统直接进行交互的类型，UTC</p></li></ul></li> <li><p>结构体 struct tm</p> <ul><li><p>将 UTC 时间根据系统设置的时区进行分解</p> <p>Java Python 等都遇到过</p></li></ul></li> <li><p>字符串</p> <p>例如：Tue Jul ...</p></li></ul> <h3 id="_7-3-2-时间转换函数"><a href="#_7-3-2-时间转换函数" class="header-anchor">#</a> 7.3.2 时间转换函数</h3> <div class="language-c extra-class"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;time.h&gt;</span></span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        time_t nowtime<span class="token punctuation">;</span>
        <span class="token keyword">char</span> <span class="token operator">*</span>nowtime2<span class="token punctuation">;</span>
        <span class="token keyword">struct</span> <span class="token class-name">tm</span> <span class="token operator">*</span>nowtime3<span class="token punctuation">;</span>
        <span class="token function">time</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>nowtime<span class="token punctuation">)</span><span class="token punctuation">;</span>
        nowtime2<span class="token operator">=</span><span class="token function">ctime</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>nowtime<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%s&quot;</span><span class="token punctuation">,</span> nowtime2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        nowtime3<span class="token operator">=</span><span class="token function">localtime</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>nowtime<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span>&quot;<span class="token operator">%</span>d<span class="token operator">-</span><span class="token operator">%</span>d<span class="token operator">-</span><span class="token operator">%</span>d<span class="token punctuation">;</span><span class="token operator">%</span>d
               
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_7-4-错误代码"><a href="#_7-4-错误代码" class="header-anchor">#</a> 7.4 错误代码</h2> <h3 id="error"><a href="#error" class="header-anchor">#</a> error</h3> <ul><li>error number</li></ul> <p>​	引入头文件 error.h</p> <ul><li>strerror</li> <li>perror</li></ul> <h1 id="第八次课-文件-io"><a href="#第八次课-文件-io" class="header-anchor">#</a> 第八次课 文件 IO</h1> <h2 id="_8-1-标准io-与文件-io"><a href="#_8-1-标准io-与文件-io" class="header-anchor">#</a> 8.1 标准IO 与文件 IO</h2> <ul><li><p>标准 IO</p> <p>语言提供的 IO，对平台提供的文件操作 API 有封装，换平台重新编译即可，可移植性强。</p> <ul><li><p>全缓冲</p> <p>填满标准 IO 缓冲区再进行实际 IO。</p></li> <li><p>行缓冲</p> <p>遇到换行执行一次实际 IO，终端就是用的这个。</p></li></ul></li> <li><p>文件 IO</p></li></ul> <h2 id="_8-2-文件系统简介"><a href="#_8-2-文件系统简介" class="header-anchor">#</a> 8.2 文件系统简介</h2> <h3 id="文件系统类型"><a href="#文件系统类型" class="header-anchor">#</a> 文件系统类型</h3> <ul><li>Linux：ext2，ext3</li> <li>Windows：NTFS，FAT</li> <li>macOS：APFS</li></ul> <h3 id="vfs-虚拟文件系统"><a href="#vfs-虚拟文件系统" class="header-anchor">#</a> VFS 虚拟文件系统</h3> <p>作用：屏蔽不同文件系统的不同之处，对应用程序和用户透明的（他们感受不到文件系统的差异）。</p> <h4 id="索引节点-inode"><a href="#索引节点-inode" class="header-anchor">#</a> 索引节点 inode</h4> <ul><li><p>Linux 采取 “按名存取” 访问文件。</p></li> <li><p>文件分为两部分</p> <ul><li><p>索引节点 inode</p> <ul><li><p>记录文件的属性信息（不包括文件名）。可以用 ls -l 查看</p></li> <li><p>数据块</p> <p>文件具体内容</p></li></ul></li></ul></li> <li><p><strong>目录文件</strong> 中保存着 <strong>文件名</strong> 和 <strong>索引节点</strong> inode 的对应关系。</p></li></ul> <h3 id="一个简单的-unix-文件系统组成"><a href="#一个简单的-unix-文件系统组成" class="header-anchor">#</a> 一个简单的 Unix 文件系统组成</h3> <ul><li><p><strong>引导块</strong>：EFI 分区位于的地方</p></li> <li><p><strong>超级块</strong></p></li> <li><p>索引节点表 （ inode ）</p></li> <li><p>数据块</p></li></ul> <h3 id="文件类型"><a href="#文件类型" class="header-anchor">#</a> 文件类型</h3> <ul><li>普通文件</li> <li>目录文件</li> <li>字符设备文件</li> <li>块设备文件</li> <li><font color="red">FIFO 文件</font></li> <li>符号链接文件</li> <li><font color="red">socket 套接字文件</font></li></ul> <h3 id="文件权限"><a href="#文件权限" class="header-anchor">#</a> 文件权限</h3> <ul><li><p>字母</p> <p>r：read</p> <p>w：write</p> <p>x：execute 执行</p> <p><code>-</code> ：无权限</p></li> <li><p>数字</p> <p>chmod 777 filename</p></li> <li><p>宏</p> <p>了解即可，用的不多。编程时常用 <font color="red">数字</font> 表示权限</p></li></ul> <h3 id="访问文件的内核数据结构"><a href="#访问文件的内核数据结构" class="header-anchor">#</a> 访问文件的内核数据结构</h3> <p>进程默认打开三个描述符</p> <h3 id="常用系统调用"><a href="#常用系统调用" class="header-anchor">#</a> 常用系统调用</h3> <h4 id="_1-创建-打开-文件"><a href="#_1-创建-打开-文件" class="header-anchor">#</a> 1. 创建/打开 文件</h4> <div class="language-c extra-class"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;sys/stat.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;fcntl.h&gt;</span></span>
 <span class="token keyword">int</span> <span class="token function">open</span> <span class="token punctuation">(</span> 参数待补充 <span class="token punctuation">)</span>
</code></pre></div><ul><li><p>打开已存在的文件时 perms 参数不用提供</p></li> <li><p>新建文件需要 perms 参数</p></li> <li><p>参数</p> <ul><li>path</li> <li>flags：打开方式，可用或运算 <code>|</code></li> <li>perms</li></ul></li> <li><p>返回值</p> <p>用于判断文件打开出错没</p> <ul><li>-1：出错</li> <li>0：成功</li></ul></li></ul> <h4 id="_2-关闭文件"><a href="#_2-关闭文件" class="header-anchor">#</a> 2. 关闭文件</h4> <div class="language-c extra-class"><pre class="language-c"><code><span class="token keyword">int</span> <span class="token function">close</span><span class="token punctuation">(</span>fd<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="_3-练习"><a href="#_3-练习" class="header-anchor">#</a> 3. 练习</h4> <p>P73 例 4-4</p> <p>fd.c</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;fcntl.h&gt;</span></span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token keyword">const</span> <span class="token operator">*</span>argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> fd1<span class="token punctuation">,</span> fd2<span class="token punctuation">,</span> fd3<span class="token punctuation">;</span>
    fd1 <span class="token operator">=</span> <span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&quot;f1&quot;</span><span class="token punctuation">,</span> O_RDWR<span class="token punctuation">)</span><span class="token punctuation">;</span>
    fd2 <span class="token operator">=</span> <span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&quot;f2&quot;</span><span class="token punctuation">,</span> O_RDWR<span class="token punctuation">)</span><span class="token punctuation">;</span>
    fd3 <span class="token operator">=</span> <span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&quot;f3&quot;</span><span class="token punctuation">,</span> O_RDWR<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;fd1=%d\n&quot;</span><span class="token punctuation">,</span>fd1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;fd2=%d\n&quot;</span><span class="token punctuation">,</span>fd2<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;fd3=%d\n&quot;</span><span class="token punctuation">,</span>fd3<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">close</span><span class="token punctuation">(</span>fd1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">close</span><span class="token punctuation">(</span>fd2<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">close</span><span class="token punctuation">(</span>fd3<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><hr> <p>fd1.c</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;fcntl.h&gt;</span></span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token keyword">const</span> <span class="token operator">*</span>argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> fd1<span class="token punctuation">,</span> fd2<span class="token punctuation">,</span> fd3<span class="token punctuation">;</span>
    fd1 <span class="token operator">=</span> <span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&quot;f1&quot;</span><span class="token punctuation">,</span> O_RDWR<span class="token punctuation">)</span><span class="token punctuation">;</span>
    fd2 <span class="token operator">=</span> <span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&quot;f2&quot;</span><span class="token punctuation">,</span> O_RDWR<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;fd1=%d\n&quot;</span><span class="token punctuation">,</span>fd1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;fd2=%d\n&quot;</span><span class="token punctuation">,</span>fd2<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">close</span><span class="token punctuation">(</span>fd1<span class="token punctuation">)</span><span class="token punctuation">;</span>

    fd3 <span class="token operator">=</span> <span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&quot;f3&quot;</span><span class="token punctuation">,</span> O_RDWR<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;fd3=%d\n&quot;</span><span class="token punctuation">,</span>fd3<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">close</span><span class="token punctuation">(</span>fd2<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">close</span><span class="token punctuation">(</span>fd3<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><p>创建文件 f1 f2 f3，再编译运行。</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">touch</span> f1 f2 f3
</code></pre></div><p>输出</p> <ul><li><p>fd：3 4 5</p> <ul><li>进程执行的时候打开了三个文件（中间没有关闭），进程描述符分别占用 3 4 5 号。</li></ul></li> <li><p>fd1：3 4 3</p> <ul><li>进程执行的时候先打开了两个文件，进程描述符分别占用 3 4 号，先关闭了 fd1，再打开 fd3。系统调用 open 每次打开文件总是得到一个最小的可用文件描述符。</li></ul></li></ul> <p>具体解释看 P74。</p> <h4 id="close-与-文件描述符"><a href="#close-与-文件描述符" class="header-anchor">#</a> close 与 文件描述符</h4> <p>进程 open 文件时，系统有一张表记录进程打开的文件。</p> <p>close 一个 fd，fd 指向的打开文件列表中引用计数器减1，如果减为0，不仅释放文件描述符，还释放该打开文件表项。</p> <h4 id="_4-读文件"><a href="#_4-读文件" class="header-anchor">#</a> 4. 读文件</h4> <div class="language-c extra-class"><pre class="language-c"><code>ssize_ <span class="token function">read</span><span class="token punctuation">(</span>fd<span class="token punctuation">,</span> buf<span class="token punctuation">,</span> nbytes<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li><p>参数</p> <ul><li>fd：文件描述符</li> <li>buf：读出的数据放在哪个缓冲区</li> <li>nbytes：读取多少个字节</li></ul></li> <li><p>返回值</p> <ul><li>-1：失败</li> <li>成功：返回已读取的字符数。</li></ul> <p>只通过返回值是否为 -1 判断读取失败。</p></li></ul> <h4 id="文件偏移量"><a href="#文件偏移量" class="header-anchor">#</a> 文件偏移量</h4> <p>指针从文件头字符的移动量</p> <h4 id="文件定位函数-lseek"><a href="#文件定位函数-lseek" class="header-anchor">#</a> 文件定位函数 lseek</h4> <div class="language-c extra-class"><pre class="language-c"><code>off_t <span class="token function">lseek</span><span class="token punctuation">(</span><span class="token keyword">int</span> fd<span class="token punctuation">,</span> off_t pos<span class="token punctuation">,</span> <span class="token keyword">int</span> whence<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li><p>参数</p> <ul><li><p>fd</p></li> <li><p>whence</p> <ul><li><p>SEEK_SET</p> <p>以文件开始作为起点。</p></li></ul></li> <li><p>pos</p> <p>可正可负 0 ，相对于 whence 的偏移量</p></li></ul></li> <li><p>返回值</p> <ul><li>-1</li> <li>...</li> <li></li></ul></li></ul> <h4 id="open-与文件描述符"><a href="#open-与文件描述符" class="header-anchor">#</a> open 与文件描述符</h4> <h4 id="close-与文件描述符"><a href="#close-与文件描述符" class="header-anchor">#</a> close 与文件描述符</h4> <h4 id="文件偏移量举例"><a href="#文件偏移量举例" class="header-anchor">#</a> 文件偏移量举例</h4> <p>例 4-6 两次打开同一个文件进行操作</p> <p>fileopen.c</p> <div class="language-c extra-class"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;fcntl.h&gt;</span></span>

<span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">int</span> fd1<span class="token punctuation">,</span> fd2<span class="token punctuation">;</span>
    <span class="token keyword">int</span> num<span class="token punctuation">;</span>
    <span class="token keyword">char</span> buf<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    fd1 <span class="token operator">=</span> <span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&quot;f1&quot;</span><span class="token punctuation">,</span> O_RDWR <span class="token operator">|</span> O_TRUNC<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>fd1 <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">&quot;open&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;fd1 is %d\n&quot;</span><span class="token punctuation">,</span> fd1<span class="token punctuation">)</span><span class="token punctuation">;</span>

    fd2 <span class="token operator">=</span> <span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&quot;f1&quot;</span><span class="token punctuation">,</span> O_RDWR<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>fd2 <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">perror</span><span class="token punctuation">(</span><span class="token string">&quot;open&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;fd2 is %d\n&quot;</span><span class="token punctuation">,</span> fd2<span class="token punctuation">)</span><span class="token punctuation">;</span>

    num <span class="token operator">=</span> <span class="token function">write</span><span class="token punctuation">(</span>fd1<span class="token punctuation">,</span> <span class="token string">&quot;hello world!&quot;</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;fd1:write num=%d bytes into f1\n&quot;</span><span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">;</span>
    num <span class="token operator">=</span> <span class="token function">read</span><span class="token punctuation">(</span>fd2<span class="token punctuation">,</span> buf<span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    buf<span class="token punctuation">[</span>num<span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;fd2:read %d bytes from f1: %s\n&quot;</span><span class="token punctuation">,</span> num<span class="token punctuation">,</span> buf<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">close</span><span class="token punctuation">(</span>fd1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">close</span><span class="token punctuation">(</span>fd2<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre></div><hr> <div class="language-shell extra-class"><pre class="language-shell"><code>gcc -o fileopen ./fileopen.c
</code></pre></div><p>运行输出</p> <div class="language- extra-class"><pre class="language-text"><code>fd1 is 3
fd2 is 4
fd1:write num=12 bytes into f1
fd2:read 12 bytes from f1: hello world!
</code></pre></div><h4 id="硬链接与符号链接-软链接"><a href="#硬链接与符号链接-软链接" class="header-anchor">#</a> 硬链接与符号链接（软链接）</h4> <h4 id="文件权限修饰位-setuid"><a href="#文件权限修饰位-setuid" class="header-anchor">#</a> 文件权限修饰位 - setuid</h4> <p>setuid 改变文件权限，让普通用户获得部分 root 用户才有的权限。</p> <h4 id="dup-dup2"><a href="#dup-dup2" class="header-anchor">#</a> dup/dup2</h4> <ul><li><p>重定向</p></li> <li><p>两个函数</p> <ul><li><p>dup</p></li> <li><p>dup2</p></li></ul></li></ul></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/chengziqaq/Note/edit/master/cs/Linux/linux.md" target="_blank" rel="noopener noreferrer"> Edit on Github </a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">10/22/2020, 8:21:46 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ⟵
      <a href="/Note/cs/csBasic/math/离散数学.html" class="prev">
        离散数学
      </a></span> <span class="next"><a href="/Note/cs/Linux/shell.html">
        shell 编程
      </a>
      ⟶
    </span></p></div> </main></div><div class="global-ui"><div style="visibility:hidden;display:none;"></div><!----></div></div>
    <script src="/Note/assets/js/app.8bf72d68.js" defer></script><script src="/Note/assets/js/4.ed70c863.js" defer></script><script src="/Note/assets/js/31.9f5f5098.js" defer></script><script src="/Note/assets/js/24.b41ee11a.js" defer></script>
  </body>
</html>
